# NDR-Suricata-Zeek-ELK-MachineLearning

## 1. Introduction
**Objectives**
- Develop an Elastic dashboard (Elasticsearch, Kibana) to visualize abnormal traffic patterns and log-based alerts, enabling timely detection, response, and post-incident investigation and evaluation.
- Build an NDR (Network Detection and Response) system using open-source, free, and user-friendly resources.
- Integrate Suricata and Zeek—two powerful open-source tools—alongside the Elastic framework (Filebeat, Elasticsearch, Kibana) to support data visualization. This cost-effective yet highly efficient solution is well-suited even for small and medium-sized enterprises. Additionally, incorporate a custom-developed AI-based IDS (Intrusion Detection System).
- Design a system architecture centered around a core switch, ensuring all network traffic is routed through this device and mirrored to the NDR system. This solution allows seamless integration with various tools beyond just NDR and Elastic.
- Create scripts to interface with the core switch for applying IP blocking rules. Additionally, implement automated scripts to notify administrators via email alerts.

## 2. Business Requirements
1. **Scalability and Adaptability**:  The Elastic dashboard (Elasticsearch, Kibana) supports visualization and statistical analysis (e.g., timestamp, source, destination, rule.name) of alert and attack data aggregated from logs generated by Suricata, Zeek, and the custom AI-based IDS.
2. **Sophisticated Threat Detection**: It enables early and accurate detection of abnormal traffic and behaviors within the internal network, such as TCP SYN Flood (DoS), Reverse Shells, SQL Injection, and more.
3. **Short Latency Response**: As soon as logs are collected via Filebeat and ingested into Elasticsearch, automated scripts will filter and detect attack patterns based on the log data, block the corresponding source IPs, and send out alert notifications via email.
4. **Scalability and Adaptability**: Elasticsearch's ability to collect logs from various sources facilitates integration with multiple security tools, supporting seamless management and scalability.
5. **Operational Needs**: The NDR solution must be designed and implemented to minimize business disruption and allow easy integration into existing operational workflows.

## 3.Non-Business Requirements
1. **Infrastructure**: Minimum Hardware Requirements
- VM – NDR (Zeek & Suricata): 6GB RAM, 4 CPU cores
- VM – ELK Stack: 6GB RAM, 4 CPU cores
- Recommended OS: Ubuntu Server (20.04 LTS / 22.04 LTS)
- Essential tools: Suricata, Zeek, Filebeat, Elasticsearch, Kibana (latest versions), and relevant Python libraries

2. **Performance Expectations**:
- The system must process logs from Suricata and Zeek without exceeding 70% CPU utilization or 80% RAM usage under normal traffic load
- Capable of real-time processing of high-volume network traffic ranging from several hundred Mbps to multiple Gbps
- Threat detection latency should be under 3 seconds from the moment a suspicious packet is observed

3. **Log Retention and Storage Strategy**:
- Minimum log retention period: 12 months
- Hot Storage (7–30 days): Logs must be stored on high-speed storage for quick retrieval
- Warm Storage (1–3 months): Logs can be stored on slower disks, with acceptable access latency
- Cold Storage (3–12 months): Logs may be compressed and stored on low-speed devices; retrieval is slower but still suitable for forensic analysis or attack scope determination

## 4. Architecture
1. **Deploy Architecture**
![image](https://github.com/grapitycreation/NDR-Suricata-Zeek-ELK-MachineLearning/blob/main/Images/image6.png)

2. **Data Architecture**
![image](https://github.com/grapitycreation/NDR-Suricata-Zeek-ELK-MachineLearning/blob/main/Images/image7.png)

3. **IDS-AI Based Architecture**
![image](https://github.com/grapitycreation/NDR-Suricata-Zeek-ELK-MachineLearning/blob/main/Images/image8.png)

4. **Response WorkFlow**:
![image](https://github.com/grapitycreation/NDR-Suricata-Zeek-ELK-MachineLearning/blob/main/Images/image9.png)










